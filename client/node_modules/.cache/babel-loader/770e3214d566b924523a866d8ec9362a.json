{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _invoke from \"lodash/invoke\";\nimport _forEach from \"lodash/forEach\";\nimport _without from \"lodash/without\";\nimport _includes from \"lodash/includes\";\nimport { Ref } from '@stardust-ui/react-component-ref';\nimport PropTypes from 'prop-types';\nimport React, { Component, createRef } from 'react';\nimport { eventStack, getElementType, getUnhandledProps, normalizeOffset, isBrowser } from '../../lib';\n/**\r\n * Visibility provides a set of callbacks for when a content appears in the viewport.\r\n */\n\nvar Visibility =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Visibility, _Component);\n\n  function Visibility() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Visibility);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Visibility)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"calculations\", {\n      bottomPassed: false,\n      bottomVisible: false,\n      fits: false,\n      passing: false,\n      offScreen: false,\n      onScreen: false,\n      topPassed: false,\n      topVisible: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"firedCallbacks\", []);\n\n    _defineProperty(_assertThisInitialized(_this), \"ref\", createRef());\n\n    _defineProperty(_assertThisInitialized(_this), \"fire\", function (_ref, value) {\n      var callback = _ref.callback,\n          name = _ref.name;\n      var reverse = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var _this$props = _this.props,\n          continuous = _this$props.continuous,\n          once = _this$props.once; // Heads up! For the execution is required:\n      // - current value correspond to the fired direction\n      // - `continuous` is true or calculation values are different\n\n      var matchesDirection = _this.calculations[value] !== reverse;\n      var executionPossible = continuous || _this.calculations[value] !== _this.oldCalculations[value];\n      if (matchesDirection && executionPossible) _this.execute(callback, name); // Heads up! We should remove callback from the happened when it's not `once`\n\n      if (!once) _this.firedCallbacks = _without(_this.firedCallbacks, name);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleUpdate\", function () {\n      if (_this.ticking) return;\n      _this.ticking = true;\n      _this.frameId = requestAnimationFrame(_this.update);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"update\", function () {\n      if (!_this.mounted) return;\n      _this.ticking = false;\n      _this.oldCalculations = _this.calculations;\n      _this.calculations = _this.computeCalculations();\n      _this.pageYOffset = _this.getPageYOffset();\n      var _this$props2 = _this.props,\n          onBottomPassed = _this$props2.onBottomPassed,\n          onBottomPassedReverse = _this$props2.onBottomPassedReverse,\n          onBottomVisible = _this$props2.onBottomVisible,\n          onBottomVisibleReverse = _this$props2.onBottomVisibleReverse,\n          onPassing = _this$props2.onPassing,\n          onPassingReverse = _this$props2.onPassingReverse,\n          onTopPassed = _this$props2.onTopPassed,\n          onTopPassedReverse = _this$props2.onTopPassedReverse,\n          onTopVisible = _this$props2.onTopVisible,\n          onTopVisibleReverse = _this$props2.onTopVisibleReverse,\n          onOffScreen = _this$props2.onOffScreen,\n          onOnScreen = _this$props2.onOnScreen,\n          updateOn = _this$props2.updateOn;\n      var forward = {\n        bottomPassed: {\n          callback: onBottomPassed,\n          name: 'onBottomPassed'\n        },\n        bottomVisible: {\n          callback: onBottomVisible,\n          name: 'onBottomVisible'\n        },\n        passing: {\n          callback: onPassing,\n          name: 'onPassing'\n        },\n        offScreen: {\n          callback: onOffScreen,\n          name: 'onOffScreen'\n        },\n        onScreen: {\n          callback: onOnScreen,\n          name: 'onOnScreen'\n        },\n        topPassed: {\n          callback: onTopPassed,\n          name: 'onTopPassed'\n        },\n        topVisible: {\n          callback: onTopVisible,\n          name: 'onTopVisible'\n        }\n      };\n      var reverse = {\n        bottomPassed: {\n          callback: onBottomPassedReverse,\n          name: 'onBottomPassedReverse'\n        },\n        bottomVisible: {\n          callback: onBottomVisibleReverse,\n          name: 'onBottomVisibleReverse'\n        },\n        passing: {\n          callback: onPassingReverse,\n          name: 'onPassingReverse'\n        },\n        topPassed: {\n          callback: onTopPassedReverse,\n          name: 'onTopPassedReverse'\n        },\n        topVisible: {\n          callback: onTopVisibleReverse,\n          name: 'onTopVisibleReverse'\n        }\n      };\n\n      _invoke(_this.props, 'onUpdate', null, _objectSpread({}, _this.props, {\n        calculations: _this.calculations\n      }));\n\n      _this.fireOnPassed(); // Heads up! Reverse callbacks should be fired first\n\n\n      _forEach(reverse, function (data, value) {\n        return _this.fire(data, value, true);\n      });\n\n      _forEach(forward, function (data, value) {\n        return _this.fire(data, value);\n      });\n\n      if (updateOn === 'repaint') _this.handleUpdate();\n    });\n\n    return _this;\n  }\n\n  _createClass(Visibility, [{\n    key: \"UNSAFE_componentWillReceiveProps\",\n    // ----------------------------------------\n    // Lifecycle\n    // ----------------------------------------\n    // eslint-disable-next-line camelcase\n    value: function UNSAFE_componentWillReceiveProps(_ref2) {\n      var continuous = _ref2.continuous,\n          once = _ref2.once,\n          context = _ref2.context,\n          updateOn = _ref2.updateOn;\n      var cleanHappened = continuous !== this.props.continuous || once !== this.props.once || updateOn !== this.props.updateOn; // Heads up! We should clean up array of happened callbacks, if values of these props are changed\n\n      if (cleanHappened) this.firedCallbacks = [];\n\n      if (context !== this.props.context || updateOn !== this.props.updateOn) {\n        this.unattachHandlers(this.props.context);\n        this.attachHandlers(context, updateOn);\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.mounted = true;\n      if (!isBrowser()) return;\n      var _this$props3 = this.props,\n          context = _this$props3.context,\n          fireOnMount = _this$props3.fireOnMount,\n          updateOn = _this$props3.updateOn;\n      this.pageYOffset = this.getPageYOffset();\n      this.attachHandlers(context, updateOn);\n      if (fireOnMount) this.update();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var context = this.props.context;\n      this.unattachHandlers(context);\n      this.mounted = false;\n    }\n  }, {\n    key: \"attachHandlers\",\n    value: function attachHandlers(context, updateOn) {\n      if (updateOn === 'events') {\n        if (context) {\n          eventStack.sub('resize', this.handleUpdate, {\n            target: context\n          });\n          eventStack.sub('scroll', this.handleUpdate, {\n            target: context\n          });\n        }\n\n        return;\n      } // Heads up!\n      // We will deal with `repaint` there\n\n\n      this.handleUpdate();\n    }\n  }, {\n    key: \"unattachHandlers\",\n    value: function unattachHandlers(context) {\n      if (context) {\n        eventStack.unsub('resize', this.handleUpdate, {\n          target: context\n        });\n        eventStack.unsub('scroll', this.handleUpdate, {\n          target: context\n        });\n      }\n\n      if (this.frameId) cancelAnimationFrame(this.frameId);\n    } // ----------------------------------------\n    // Callback handling\n    // ----------------------------------------\n\n  }, {\n    key: \"execute\",\n    value: function execute(callback, name) {\n      var continuous = this.props.continuous;\n      if (!callback) return; // Heads up! When `continuous` is true, callback will be fired always\n\n      if (!continuous && _includes(this.firedCallbacks, name)) return;\n      callback(null, _objectSpread({}, this.props, {\n        calculations: this.calculations\n      }));\n      this.firedCallbacks.push(name);\n    }\n  }, {\n    key: \"fireOnPassed\",\n    value: function fireOnPassed() {\n      var _this2 = this;\n\n      var _this$calculations = this.calculations,\n          percentagePassed = _this$calculations.percentagePassed,\n          pixelsPassed = _this$calculations.pixelsPassed;\n      var onPassed = this.props.onPassed;\n\n      _forEach(onPassed, function (callback, passed) {\n        var pixelsValue = Number(passed);\n\n        if (pixelsValue && pixelsPassed >= pixelsValue) {\n          _this2.execute(callback, passed);\n\n          return;\n        }\n\n        var matchPercentage = \"\".concat(passed).match(/^(\\d+)%$/);\n        if (!matchPercentage) return;\n        var percentageValue = Number(matchPercentage[1]) / 100;\n        if (percentagePassed >= percentageValue) _this2.execute(callback, passed);\n      });\n    }\n  }, {\n    key: \"computeCalculations\",\n    // ----------------------------------------\n    // Helpers\n    // ----------------------------------------\n    value: function computeCalculations() {\n      var offset = this.props.offset;\n\n      var _this$ref$current$get = this.ref.current.getBoundingClientRect(),\n          bottom = _this$ref$current$get.bottom,\n          height = _this$ref$current$get.height,\n          top = _this$ref$current$get.top,\n          width = _this$ref$current$get.width;\n\n      var _normalizeOffset = normalizeOffset(offset),\n          _normalizeOffset2 = _slicedToArray(_normalizeOffset, 2),\n          topOffset = _normalizeOffset2[0],\n          bottomOffset = _normalizeOffset2[1];\n\n      var newOffset = this.getPageYOffset();\n      var direction = newOffset > this.pageYOffset ? 'down' : 'up';\n      var topPassed = top < topOffset;\n      var bottomPassed = bottom < bottomOffset;\n      var pixelsPassed = bottomPassed ? 0 : Math.max(top * -1, 0);\n      var percentagePassed = pixelsPassed / height;\n      var bottomVisible = bottom >= bottomOffset && bottom <= window.innerHeight;\n      var topVisible = top >= topOffset && top <= window.innerHeight;\n      var fits = topVisible && bottomVisible;\n      var passing = topPassed && !bottomPassed;\n      var onScreen = (topVisible || topPassed) && !bottomPassed;\n      var offScreen = !onScreen;\n      return {\n        bottomPassed: bottomPassed,\n        bottomVisible: bottomVisible,\n        direction: direction,\n        fits: fits,\n        height: height,\n        passing: passing,\n        percentagePassed: percentagePassed,\n        pixelsPassed: pixelsPassed,\n        offScreen: offScreen,\n        onScreen: onScreen,\n        topPassed: topPassed,\n        topVisible: topVisible,\n        width: width\n      };\n    }\n  }, {\n    key: \"getPageYOffset\",\n    value: function getPageYOffset() {\n      var context = this.props.context;\n\n      if (context) {\n        // Heads up! `window` doesn't have `pageYOffset` property\n        return context === window ? window.pageYOffset : context.scrollTop;\n      }\n\n      return 0;\n    } // ----------------------------------------\n    // Render\n    // ----------------------------------------\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var children = this.props.children;\n      var ElementType = getElementType(Visibility, this.props);\n      var rest = getUnhandledProps(Visibility, this.props);\n      return React.createElement(Ref, {\n        innerRef: this.ref\n      }, React.createElement(ElementType, rest, children));\n    }\n  }]);\n\n  return Visibility;\n}(Component);\n\n_defineProperty(Visibility, \"defaultProps\", {\n  context: isBrowser() ? window : null,\n  continuous: false,\n  offset: [0, 0],\n  once: true,\n  updateOn: 'events'\n});\n\n_defineProperty(Visibility, \"handledProps\", [\"as\", \"children\", \"context\", \"continuous\", \"fireOnMount\", \"offset\", \"onBottomPassed\", \"onBottomPassedReverse\", \"onBottomVisible\", \"onBottomVisibleReverse\", \"onOffScreen\", \"onOnScreen\", \"onPassed\", \"onPassing\", \"onPassingReverse\", \"onTopPassed\", \"onTopPassedReverse\", \"onTopVisible\", \"onTopVisibleReverse\", \"onUpdate\", \"once\", \"updateOn\"]);\n\nexport { Visibility as default };\nVisibility.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  /** An element type to render as (string or function). */\n  as: PropTypes.elementType,\n\n  /** Primary content. */\n  children: PropTypes.node,\n\n  /** Context which visibility should attach onscroll events. */\n  context: PropTypes.object,\n\n  /**\r\n   * When set to true a callback will occur anytime an element passes a condition not just immediately after the\r\n   * threshold is met.\r\n   */\n  continuous: PropTypes.bool,\n\n  /** Fires callbacks immediately after mount. */\n  fireOnMount: PropTypes.bool,\n\n  /**\r\n   * Element's bottom edge has passed top of screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\n  onBottomPassed: PropTypes.func,\n\n  /**\r\n   * Element's bottom edge has not passed top of screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\n  onBottomPassedReverse: PropTypes.func,\n\n  /**\r\n   * Element's bottom edge has passed bottom of screen\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\n  onBottomVisible: PropTypes.func,\n\n  /**\r\n   * Element's bottom edge has not passed bottom of screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\n  onBottomVisibleReverse: PropTypes.func,\n\n  /**\r\n   * Value that context should be adjusted in pixels. Useful for making content appear below content fixed to the\r\n   * page.\r\n   */\n  offset: PropTypes.oneOfType([PropTypes.number, PropTypes.string, PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.number, PropTypes.string]))]),\n\n  /** When set to false a callback will occur each time an element passes the threshold for a condition. */\n  once: PropTypes.bool,\n\n  /** Element is not visible on the screen. */\n  onPassed: PropTypes.object,\n\n  /**\r\n   * Any part of an element is visible on screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\n  onPassing: PropTypes.func,\n\n  /**\r\n   * Element's top has not passed top of screen but bottom has.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\n  onPassingReverse: PropTypes.func,\n\n  /**\r\n   * Element is not visible on the screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\n  onOffScreen: PropTypes.func,\n\n  /**\r\n   * Element is visible on the screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\n  onOnScreen: PropTypes.func,\n\n  /**\r\n   * Element's top edge has passed top of the screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\n  onTopPassed: PropTypes.func,\n\n  /**\r\n   * Element's top edge has not passed top of the screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\n  onTopPassedReverse: PropTypes.func,\n\n  /**\r\n   * Element's top edge has passed bottom of screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\n  onTopVisible: PropTypes.func,\n\n  /**\r\n   * Element's top edge has not passed bottom of screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\n  onTopVisibleReverse: PropTypes.func,\n\n  /**\r\n   * Element's top edge has passed bottom of screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\n  onUpdate: PropTypes.func,\n\n  /**\r\n   * Allows to choose the mode of the position calculations:\r\n   * - `events` - (default) update and fire callbacks only on scroll/resize events\r\n   * - `repaint` - update and fire callbacks on browser repaint (animation frames)\r\n   */\n  updateOn: PropTypes.oneOf(['events', 'repaint'])\n} : {};","map":{"version":3,"sources":["C:/Projects/StudyManagement/client/node_modules/semantic-ui-react/dist/es/behaviors/Visibility/Visibility.js"],"names":["_slicedToArray","_objectSpread","_classCallCheck","_createClass","_possibleConstructorReturn","_getPrototypeOf","_assertThisInitialized","_inherits","_defineProperty","_invoke","_forEach","_without","_includes","Ref","PropTypes","React","Component","createRef","eventStack","getElementType","getUnhandledProps","normalizeOffset","isBrowser","Visibility","_Component","_getPrototypeOf2","_this","_len","arguments","length","args","Array","_key","call","apply","concat","bottomPassed","bottomVisible","fits","passing","offScreen","onScreen","topPassed","topVisible","_ref","value","callback","name","reverse","undefined","_this$props","props","continuous","once","matchesDirection","calculations","executionPossible","oldCalculations","execute","firedCallbacks","ticking","frameId","requestAnimationFrame","update","mounted","computeCalculations","pageYOffset","getPageYOffset","_this$props2","onBottomPassed","onBottomPassedReverse","onBottomVisible","onBottomVisibleReverse","onPassing","onPassingReverse","onTopPassed","onTopPassedReverse","onTopVisible","onTopVisibleReverse","onOffScreen","onOnScreen","updateOn","forward","fireOnPassed","data","fire","handleUpdate","key","UNSAFE_componentWillReceiveProps","_ref2","context","cleanHappened","unattachHandlers","attachHandlers","componentDidMount","_this$props3","fireOnMount","componentWillUnmount","sub","target","unsub","cancelAnimationFrame","push","_this2","_this$calculations","percentagePassed","pixelsPassed","onPassed","passed","pixelsValue","Number","matchPercentage","match","percentageValue","offset","_this$ref$current$get","ref","current","getBoundingClientRect","bottom","height","top","width","_normalizeOffset","_normalizeOffset2","topOffset","bottomOffset","newOffset","direction","Math","max","window","innerHeight","scrollTop","render","children","ElementType","rest","createElement","innerRef","default","propTypes","process","env","NODE_ENV","as","elementType","node","object","bool","func","oneOfType","number","string","arrayOf","onUpdate","oneOf"],"mappings":"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","sourcesContent":["import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\r\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread\";\r\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\r\nimport _createClass from \"@babel/runtime/helpers/createClass\";\r\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\r\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\r\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\r\nimport _inherits from \"@babel/runtime/helpers/inherits\";\r\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\r\nimport _invoke from \"lodash/invoke\";\r\nimport _forEach from \"lodash/forEach\";\r\nimport _without from \"lodash/without\";\r\nimport _includes from \"lodash/includes\";\r\nimport { Ref } from '@stardust-ui/react-component-ref';\r\nimport PropTypes from 'prop-types';\r\nimport React, { Component, createRef } from 'react';\r\nimport { eventStack, getElementType, getUnhandledProps, normalizeOffset, isBrowser } from '../../lib';\r\n/**\r\n * Visibility provides a set of callbacks for when a content appears in the viewport.\r\n */\r\n\r\nvar Visibility =\r\n/*#__PURE__*/\r\nfunction (_Component) {\r\n  _inherits(Visibility, _Component);\r\n\r\n  function Visibility() {\r\n    var _getPrototypeOf2;\r\n\r\n    var _this;\r\n\r\n    _classCallCheck(this, Visibility);\r\n\r\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\r\n      args[_key] = arguments[_key];\r\n    }\r\n\r\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Visibility)).call.apply(_getPrototypeOf2, [this].concat(args)));\r\n\r\n    _defineProperty(_assertThisInitialized(_this), \"calculations\", {\r\n      bottomPassed: false,\r\n      bottomVisible: false,\r\n      fits: false,\r\n      passing: false,\r\n      offScreen: false,\r\n      onScreen: false,\r\n      topPassed: false,\r\n      topVisible: false\r\n    });\r\n\r\n    _defineProperty(_assertThisInitialized(_this), \"firedCallbacks\", []);\r\n\r\n    _defineProperty(_assertThisInitialized(_this), \"ref\", createRef());\r\n\r\n    _defineProperty(_assertThisInitialized(_this), \"fire\", function (_ref, value) {\r\n      var callback = _ref.callback,\r\n          name = _ref.name;\r\n      var reverse = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\r\n      var _this$props = _this.props,\r\n          continuous = _this$props.continuous,\r\n          once = _this$props.once; // Heads up! For the execution is required:\r\n      // - current value correspond to the fired direction\r\n      // - `continuous` is true or calculation values are different\r\n\r\n      var matchesDirection = _this.calculations[value] !== reverse;\r\n      var executionPossible = continuous || _this.calculations[value] !== _this.oldCalculations[value];\r\n      if (matchesDirection && executionPossible) _this.execute(callback, name); // Heads up! We should remove callback from the happened when it's not `once`\r\n\r\n      if (!once) _this.firedCallbacks = _without(_this.firedCallbacks, name);\r\n    });\r\n\r\n    _defineProperty(_assertThisInitialized(_this), \"handleUpdate\", function () {\r\n      if (_this.ticking) return;\r\n      _this.ticking = true;\r\n      _this.frameId = requestAnimationFrame(_this.update);\r\n    });\r\n\r\n    _defineProperty(_assertThisInitialized(_this), \"update\", function () {\r\n      if (!_this.mounted) return;\r\n      _this.ticking = false;\r\n      _this.oldCalculations = _this.calculations;\r\n      _this.calculations = _this.computeCalculations();\r\n      _this.pageYOffset = _this.getPageYOffset();\r\n      var _this$props2 = _this.props,\r\n          onBottomPassed = _this$props2.onBottomPassed,\r\n          onBottomPassedReverse = _this$props2.onBottomPassedReverse,\r\n          onBottomVisible = _this$props2.onBottomVisible,\r\n          onBottomVisibleReverse = _this$props2.onBottomVisibleReverse,\r\n          onPassing = _this$props2.onPassing,\r\n          onPassingReverse = _this$props2.onPassingReverse,\r\n          onTopPassed = _this$props2.onTopPassed,\r\n          onTopPassedReverse = _this$props2.onTopPassedReverse,\r\n          onTopVisible = _this$props2.onTopVisible,\r\n          onTopVisibleReverse = _this$props2.onTopVisibleReverse,\r\n          onOffScreen = _this$props2.onOffScreen,\r\n          onOnScreen = _this$props2.onOnScreen,\r\n          updateOn = _this$props2.updateOn;\r\n      var forward = {\r\n        bottomPassed: {\r\n          callback: onBottomPassed,\r\n          name: 'onBottomPassed'\r\n        },\r\n        bottomVisible: {\r\n          callback: onBottomVisible,\r\n          name: 'onBottomVisible'\r\n        },\r\n        passing: {\r\n          callback: onPassing,\r\n          name: 'onPassing'\r\n        },\r\n        offScreen: {\r\n          callback: onOffScreen,\r\n          name: 'onOffScreen'\r\n        },\r\n        onScreen: {\r\n          callback: onOnScreen,\r\n          name: 'onOnScreen'\r\n        },\r\n        topPassed: {\r\n          callback: onTopPassed,\r\n          name: 'onTopPassed'\r\n        },\r\n        topVisible: {\r\n          callback: onTopVisible,\r\n          name: 'onTopVisible'\r\n        }\r\n      };\r\n      var reverse = {\r\n        bottomPassed: {\r\n          callback: onBottomPassedReverse,\r\n          name: 'onBottomPassedReverse'\r\n        },\r\n        bottomVisible: {\r\n          callback: onBottomVisibleReverse,\r\n          name: 'onBottomVisibleReverse'\r\n        },\r\n        passing: {\r\n          callback: onPassingReverse,\r\n          name: 'onPassingReverse'\r\n        },\r\n        topPassed: {\r\n          callback: onTopPassedReverse,\r\n          name: 'onTopPassedReverse'\r\n        },\r\n        topVisible: {\r\n          callback: onTopVisibleReverse,\r\n          name: 'onTopVisibleReverse'\r\n        }\r\n      };\r\n\r\n      _invoke(_this.props, 'onUpdate', null, _objectSpread({}, _this.props, {\r\n        calculations: _this.calculations\r\n      }));\r\n\r\n      _this.fireOnPassed(); // Heads up! Reverse callbacks should be fired first\r\n\r\n\r\n      _forEach(reverse, function (data, value) {\r\n        return _this.fire(data, value, true);\r\n      });\r\n\r\n      _forEach(forward, function (data, value) {\r\n        return _this.fire(data, value);\r\n      });\r\n\r\n      if (updateOn === 'repaint') _this.handleUpdate();\r\n    });\r\n\r\n    return _this;\r\n  }\r\n\r\n  _createClass(Visibility, [{\r\n    key: \"UNSAFE_componentWillReceiveProps\",\r\n    // ----------------------------------------\r\n    // Lifecycle\r\n    // ----------------------------------------\r\n    // eslint-disable-next-line camelcase\r\n    value: function UNSAFE_componentWillReceiveProps(_ref2) {\r\n      var continuous = _ref2.continuous,\r\n          once = _ref2.once,\r\n          context = _ref2.context,\r\n          updateOn = _ref2.updateOn;\r\n      var cleanHappened = continuous !== this.props.continuous || once !== this.props.once || updateOn !== this.props.updateOn; // Heads up! We should clean up array of happened callbacks, if values of these props are changed\r\n\r\n      if (cleanHappened) this.firedCallbacks = [];\r\n\r\n      if (context !== this.props.context || updateOn !== this.props.updateOn) {\r\n        this.unattachHandlers(this.props.context);\r\n        this.attachHandlers(context, updateOn);\r\n      }\r\n    }\r\n  }, {\r\n    key: \"componentDidMount\",\r\n    value: function componentDidMount() {\r\n      this.mounted = true;\r\n      if (!isBrowser()) return;\r\n      var _this$props3 = this.props,\r\n          context = _this$props3.context,\r\n          fireOnMount = _this$props3.fireOnMount,\r\n          updateOn = _this$props3.updateOn;\r\n      this.pageYOffset = this.getPageYOffset();\r\n      this.attachHandlers(context, updateOn);\r\n      if (fireOnMount) this.update();\r\n    }\r\n  }, {\r\n    key: \"componentWillUnmount\",\r\n    value: function componentWillUnmount() {\r\n      var context = this.props.context;\r\n      this.unattachHandlers(context);\r\n      this.mounted = false;\r\n    }\r\n  }, {\r\n    key: \"attachHandlers\",\r\n    value: function attachHandlers(context, updateOn) {\r\n      if (updateOn === 'events') {\r\n        if (context) {\r\n          eventStack.sub('resize', this.handleUpdate, {\r\n            target: context\r\n          });\r\n          eventStack.sub('scroll', this.handleUpdate, {\r\n            target: context\r\n          });\r\n        }\r\n\r\n        return;\r\n      } // Heads up!\r\n      // We will deal with `repaint` there\r\n\r\n\r\n      this.handleUpdate();\r\n    }\r\n  }, {\r\n    key: \"unattachHandlers\",\r\n    value: function unattachHandlers(context) {\r\n      if (context) {\r\n        eventStack.unsub('resize', this.handleUpdate, {\r\n          target: context\r\n        });\r\n        eventStack.unsub('scroll', this.handleUpdate, {\r\n          target: context\r\n        });\r\n      }\r\n\r\n      if (this.frameId) cancelAnimationFrame(this.frameId);\r\n    } // ----------------------------------------\r\n    // Callback handling\r\n    // ----------------------------------------\r\n\r\n  }, {\r\n    key: \"execute\",\r\n    value: function execute(callback, name) {\r\n      var continuous = this.props.continuous;\r\n      if (!callback) return; // Heads up! When `continuous` is true, callback will be fired always\r\n\r\n      if (!continuous && _includes(this.firedCallbacks, name)) return;\r\n      callback(null, _objectSpread({}, this.props, {\r\n        calculations: this.calculations\r\n      }));\r\n      this.firedCallbacks.push(name);\r\n    }\r\n  }, {\r\n    key: \"fireOnPassed\",\r\n    value: function fireOnPassed() {\r\n      var _this2 = this;\r\n\r\n      var _this$calculations = this.calculations,\r\n          percentagePassed = _this$calculations.percentagePassed,\r\n          pixelsPassed = _this$calculations.pixelsPassed;\r\n      var onPassed = this.props.onPassed;\r\n\r\n      _forEach(onPassed, function (callback, passed) {\r\n        var pixelsValue = Number(passed);\r\n\r\n        if (pixelsValue && pixelsPassed >= pixelsValue) {\r\n          _this2.execute(callback, passed);\r\n\r\n          return;\r\n        }\r\n\r\n        var matchPercentage = \"\".concat(passed).match(/^(\\d+)%$/);\r\n        if (!matchPercentage) return;\r\n        var percentageValue = Number(matchPercentage[1]) / 100;\r\n        if (percentagePassed >= percentageValue) _this2.execute(callback, passed);\r\n      });\r\n    }\r\n  }, {\r\n    key: \"computeCalculations\",\r\n    // ----------------------------------------\r\n    // Helpers\r\n    // ----------------------------------------\r\n    value: function computeCalculations() {\r\n      var offset = this.props.offset;\r\n\r\n      var _this$ref$current$get = this.ref.current.getBoundingClientRect(),\r\n          bottom = _this$ref$current$get.bottom,\r\n          height = _this$ref$current$get.height,\r\n          top = _this$ref$current$get.top,\r\n          width = _this$ref$current$get.width;\r\n\r\n      var _normalizeOffset = normalizeOffset(offset),\r\n          _normalizeOffset2 = _slicedToArray(_normalizeOffset, 2),\r\n          topOffset = _normalizeOffset2[0],\r\n          bottomOffset = _normalizeOffset2[1];\r\n\r\n      var newOffset = this.getPageYOffset();\r\n      var direction = newOffset > this.pageYOffset ? 'down' : 'up';\r\n      var topPassed = top < topOffset;\r\n      var bottomPassed = bottom < bottomOffset;\r\n      var pixelsPassed = bottomPassed ? 0 : Math.max(top * -1, 0);\r\n      var percentagePassed = pixelsPassed / height;\r\n      var bottomVisible = bottom >= bottomOffset && bottom <= window.innerHeight;\r\n      var topVisible = top >= topOffset && top <= window.innerHeight;\r\n      var fits = topVisible && bottomVisible;\r\n      var passing = topPassed && !bottomPassed;\r\n      var onScreen = (topVisible || topPassed) && !bottomPassed;\r\n      var offScreen = !onScreen;\r\n      return {\r\n        bottomPassed: bottomPassed,\r\n        bottomVisible: bottomVisible,\r\n        direction: direction,\r\n        fits: fits,\r\n        height: height,\r\n        passing: passing,\r\n        percentagePassed: percentagePassed,\r\n        pixelsPassed: pixelsPassed,\r\n        offScreen: offScreen,\r\n        onScreen: onScreen,\r\n        topPassed: topPassed,\r\n        topVisible: topVisible,\r\n        width: width\r\n      };\r\n    }\r\n  }, {\r\n    key: \"getPageYOffset\",\r\n    value: function getPageYOffset() {\r\n      var context = this.props.context;\r\n\r\n      if (context) {\r\n        // Heads up! `window` doesn't have `pageYOffset` property\r\n        return context === window ? window.pageYOffset : context.scrollTop;\r\n      }\r\n\r\n      return 0;\r\n    } // ----------------------------------------\r\n    // Render\r\n    // ----------------------------------------\r\n\r\n  }, {\r\n    key: \"render\",\r\n    value: function render() {\r\n      var children = this.props.children;\r\n      var ElementType = getElementType(Visibility, this.props);\r\n      var rest = getUnhandledProps(Visibility, this.props);\r\n      return React.createElement(Ref, {\r\n        innerRef: this.ref\r\n      }, React.createElement(ElementType, rest, children));\r\n    }\r\n  }]);\r\n\r\n  return Visibility;\r\n}(Component);\r\n\r\n_defineProperty(Visibility, \"defaultProps\", {\r\n  context: isBrowser() ? window : null,\r\n  continuous: false,\r\n  offset: [0, 0],\r\n  once: true,\r\n  updateOn: 'events'\r\n});\r\n\r\n_defineProperty(Visibility, \"handledProps\", [\"as\", \"children\", \"context\", \"continuous\", \"fireOnMount\", \"offset\", \"onBottomPassed\", \"onBottomPassedReverse\", \"onBottomVisible\", \"onBottomVisibleReverse\", \"onOffScreen\", \"onOnScreen\", \"onPassed\", \"onPassing\", \"onPassingReverse\", \"onTopPassed\", \"onTopPassedReverse\", \"onTopVisible\", \"onTopVisibleReverse\", \"onUpdate\", \"once\", \"updateOn\"]);\r\n\r\nexport { Visibility as default };\r\nVisibility.propTypes = process.env.NODE_ENV !== \"production\" ? {\r\n  /** An element type to render as (string or function). */\r\n  as: PropTypes.elementType,\r\n\r\n  /** Primary content. */\r\n  children: PropTypes.node,\r\n\r\n  /** Context which visibility should attach onscroll events. */\r\n  context: PropTypes.object,\r\n\r\n  /**\r\n   * When set to true a callback will occur anytime an element passes a condition not just immediately after the\r\n   * threshold is met.\r\n   */\r\n  continuous: PropTypes.bool,\r\n\r\n  /** Fires callbacks immediately after mount. */\r\n  fireOnMount: PropTypes.bool,\r\n\r\n  /**\r\n   * Element's bottom edge has passed top of screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\r\n  onBottomPassed: PropTypes.func,\r\n\r\n  /**\r\n   * Element's bottom edge has not passed top of screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\r\n  onBottomPassedReverse: PropTypes.func,\r\n\r\n  /**\r\n   * Element's bottom edge has passed bottom of screen\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\r\n  onBottomVisible: PropTypes.func,\r\n\r\n  /**\r\n   * Element's bottom edge has not passed bottom of screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\r\n  onBottomVisibleReverse: PropTypes.func,\r\n\r\n  /**\r\n   * Value that context should be adjusted in pixels. Useful for making content appear below content fixed to the\r\n   * page.\r\n   */\r\n  offset: PropTypes.oneOfType([PropTypes.number, PropTypes.string, PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.number, PropTypes.string]))]),\r\n\r\n  /** When set to false a callback will occur each time an element passes the threshold for a condition. */\r\n  once: PropTypes.bool,\r\n\r\n  /** Element is not visible on the screen. */\r\n  onPassed: PropTypes.object,\r\n\r\n  /**\r\n   * Any part of an element is visible on screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\r\n  onPassing: PropTypes.func,\r\n\r\n  /**\r\n   * Element's top has not passed top of screen but bottom has.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\r\n  onPassingReverse: PropTypes.func,\r\n\r\n  /**\r\n   * Element is not visible on the screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\r\n  onOffScreen: PropTypes.func,\r\n\r\n  /**\r\n   * Element is visible on the screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\r\n  onOnScreen: PropTypes.func,\r\n\r\n  /**\r\n   * Element's top edge has passed top of the screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\r\n  onTopPassed: PropTypes.func,\r\n\r\n  /**\r\n   * Element's top edge has not passed top of the screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\r\n  onTopPassedReverse: PropTypes.func,\r\n\r\n  /**\r\n   * Element's top edge has passed bottom of screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\r\n  onTopVisible: PropTypes.func,\r\n\r\n  /**\r\n   * Element's top edge has not passed bottom of screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\r\n  onTopVisibleReverse: PropTypes.func,\r\n\r\n  /**\r\n   * Element's top edge has passed bottom of screen.\r\n   *\r\n   * @param {null}\r\n   * @param {object} data - All props.\r\n   */\r\n  onUpdate: PropTypes.func,\r\n\r\n  /**\r\n   * Allows to choose the mode of the position calculations:\r\n   * - `events` - (default) update and fire callbacks only on scroll/resize events\r\n   * - `repaint` - update and fire callbacks on browser repaint (animation frames)\r\n   */\r\n  updateOn: PropTypes.oneOf(['events', 'repaint'])\r\n} : {};"]},"metadata":{},"sourceType":"module"}